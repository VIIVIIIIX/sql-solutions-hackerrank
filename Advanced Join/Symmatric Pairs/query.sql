--MS SQL SERVER

WITH ORDERED_FUNCTIONS AS
(
SELECT X,
       Y,
       ROW_NUMBER() OVER(ORDER BY X, Y) AS RN
FROM FUNCTIONS
)

SELECT DISTINCT F1.X,
       F1.Y
FROM ORDERED_FUNCTIONS F1
INNER JOIN ORDERED_FUNCTIONS F2
ON F1.X = F2.Y
AND
F1.Y = F2.X
AND
F1.RN <> F2.RN
WHERE
F1.X <= F1.Y
ORDER BY F1.X
